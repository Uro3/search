var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function c(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function u(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function s(t){t.parentNode.removeChild(t)}function l(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function p(){return d(" ")}function f(){return d("")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function m(t,e){t.value=null==e?"":e}let b;function y(t){b=t}function v(){if(!b)throw new Error("Function called outside component initialization");return b}const k=[],w=[],x=[],T=[],P=Promise.resolve();let I=!1;function _(t){x.push(t)}let A=!1;const E=new Set;function R(){if(!A){A=!0;do{for(let t=0;t<k.length;t+=1){const e=k[t];y(e),D(e.$$)}for(y(null),k.length=0;w.length;)w.pop()();for(let t=0;t<x.length;t+=1){const e=x[t];E.has(e)||(E.add(e),e())}x.length=0}while(k.length);for(;T.length;)T.pop()();I=!1,A=!1,E.clear()}}function D(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const S=new Set;let C;function j(t,e){t&&t.i&&(S.delete(t),t.i(e))}function N(t,e,n,o){if(t&&t.o){if(S.has(t))return;S.add(t),C.c.push((()=>{S.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function O(t,e){const n=e.token={};function c(t,c,r,i){if(e.token!==n)return;e.resolved=i;let u=e.ctx;void 0!==r&&(u=u.slice(),u[r]=i);const a=t&&(e.current=t)(u);let s=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==c&&t&&(C={r:0,c:[],p:C},N(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),C.r||o(C.c),C=C.p)})):e.block.d(1),a.c(),j(a,1),a.m(e.mount(),e.anchor),s=!0),e.block=a,e.blocks&&(e.blocks[c]=a),s&&R()}if((r=t)&&"object"==typeof r&&"function"==typeof r.then){const n=v();if(t.then((t=>{y(n),c(e.then,1,e.value,t),y(null)}),(t=>{if(y(n),c(e.catch,2,e.error,t),y(null),!e.hasCatch)throw t})),e.current!==e.pending)return c(e.pending,0),!0}else{if(e.current!==e.then)return c(e.then,1,e.value,t),!0;e.resolved=t}var r}function U(t,e){t.d(1),e.delete(t.key)}function L(t){t&&t.c()}function K(t,n,r,i){const{fragment:u,on_mount:a,on_destroy:s,after_update:l}=t.$$;u&&u.m(n,r),i||_((()=>{const n=a.map(e).filter(c);s?s.push(...n):o(n),t.$$.on_mount=[]})),l.forEach(_)}function q(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&(k.push(t),I||(I=!0,P.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function M(e,c,r,i,u,a,l=[-1]){const d=b;y(e);const p=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:c.context||[]),callbacks:n(),dirty:l,skip_bound:!1};let f=!1;if(p.ctx=r?r(e,c.props||{},((t,n,...o)=>{const c=o.length?o[0]:n;return p.ctx&&u(p.ctx[t],p.ctx[t]=c)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](c),f&&B(e,t)),n})):[],p.update(),f=!0,o(p.before_update),p.fragment=!!i&&i(p.ctx),c.target){if(c.hydrate){const t=function(t){return Array.from(t.childNodes)}(c.target);p.fragment&&p.fragment.l(t),t.forEach(s)}else p.fragment&&p.fragment.c();c.intro&&j(e.$$.fragment),K(e,c.target,c.anchor,c.customElement),R()}y(d)}class z{$destroy(){q(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Z=[];function F(e,n=t){let o;const c=[];function i(t){if(r(e,t)&&(e=t,o)){const t=!Z.length;for(let t=0;t<c.length;t+=1){const n=c[t];n[1](),Z.push(n,e)}if(t){for(let t=0;t<Z.length;t+=2)Z[t][0](Z[t+1]);Z.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(r,u=t){const a=[r,u];return c.push(a),1===c.length&&(o=n(i)||t),r(e),()=>{const t=c.indexOf(a);-1!==t&&c.splice(t,1),0===c.length&&(o(),o=null)}}}}const V=F({endpoint:"",key:""}),G=F({totalResults:0,videos:[]}),H=F({query:""}),J=async(t,e)=>{const n=Q(t,e);console.log("api request: ",n);const o=await fetch(n),c=await o.json();return console.log("api response: ",c),{totalResults:c.pageInfo.totalResults,videos:c.items.map((t=>({id:t.id.videoId,title:t.snippet.title,thumbnailUrl:t.snippet.thumbnails.high.url,channelId:t.snippet.channelId,channelTitle:t.snippet.channelTitle,publishedAt:t.snippet.publishedAt}))),nextPageToken:c.nextPageToken,prevPageToken:c.prevPageToken}},Q=(t,e)=>{const n=new URL(`${t.endpoint}?part=snippet&type=video&q=${e.query}&key=${t.key}`);return e.channelId&&n.searchParams.append("channelId",e.channelId),e.publishedAfter&&n.searchParams.append("publishedAfter",e.publishedAfter),e.publishedBefore&&n.searchParams.append("publishedBefore",e.publishedBefore),e.pageToken&&n.searchParams.append("pageToken",e.pageToken),n.href};function W(e){let n,c,r,i,u,d,f,$,b;return{c(){n=l("input"),c=p(),r=l("input"),i=p(),u=l("input"),d=p(),f=l("button"),f.textContent="検索",g(r,"type","date"),g(u,"type","date")},m(t,o){a(t,n,o),m(n,e[2]),a(t,c,o),a(t,r,o),m(r,e[0]),a(t,i,o),a(t,u,o),m(u,e[1]),a(t,d,o),a(t,f,o),$||(b=[h(n,"input",e[5]),h(r,"input",e[6]),h(u,"input",e[7]),h(f,"click",e[3])],$=!0)},p(t,[e]){4&e&&n.value!==t[2]&&m(n,t[2]),1&e&&m(r,t[0]),2&e&&m(u,t[1])},i:t,o:t,d(t){t&&s(n),t&&s(c),t&&s(r),t&&s(i),t&&s(u),t&&s(d),t&&s(f),$=!1,o(b)}}}function X(t,e,n){let o,c,r;i(t,V,(t=>n(10,r=t)));var u=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(c,r){function i(t){try{a(o.next(t))}catch(t){r(t)}}function u(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?c(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,u)}a((o=o.apply(t,e||[])).next())}))};let{channelId:a=""}=e,s="",l="",d="";return t.$$set=t=>{"channelId"in t&&n(4,a=t.channelId)},t.$$.update=()=>{1&t.$$.dirty&&(o=l?new Date(l).toISOString():""),2&t.$$.dirty&&(c=d?new Date(d).toISOString():"")},[l,d,s,()=>u(void 0,void 0,void 0,(function*(){const t={query:s,channelId:a,publishedAfter:o,publishedBefore:c},e=yield J(r,t);console.log("result: ",e),G.set(e),H.set(t)})),a,function(){s=this.value,n(2,s)},function(){l=this.value,n(0,l)},function(){d=this.value,n(1,d)}]}class Y extends z{constructor(t){super(),M(this,t,X,W,r,{channelId:4})}}function tt(t){let e,n,o,c;return{c(){e=l("p"),n=d("検索結果: "),o=d(t[0]),c=d("件")},m(t,r){a(t,e,r),u(e,n),u(e,o),u(e,c)},p(t,e){1&e&&$(o,t[0])},d(t){t&&s(e)}}}function et(t){let e,n,o,c,r,i,f;return{c(){e=l("p"),n=d("「"),o=d(t[1]),c=d("」で検索中"),r=p(),i=l("a"),f=l("p"),f.textContent="チャンネル内検索を解除",g(i,"href",t[2].href)},m(t,s){a(t,e,s),u(e,n),u(e,o),u(e,c),a(t,r,s),a(t,i,s),u(i,f)},p(t,e){2&e&&$(o,t[1])},d(t){t&&s(e),t&&s(r),t&&s(i)}}}function nt(e){let n,o,c=e[0]&&tt(e),r=e[1]&&et(e);return{c(){c&&c.c(),n=p(),r&&r.c(),o=f()},m(t,e){c&&c.m(t,e),a(t,n,e),r&&r.m(t,e),a(t,o,e)},p(t,[e]){t[0]?c?c.p(t,e):(c=tt(t),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null),t[1]?r?r.p(t,e):(r=et(t),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},i:t,o:t,d(t){c&&c.d(t),t&&s(n),r&&r.d(t),t&&s(o)}}}function ot(t,e,n){let{totalResults:o}=e,{channelTitle:c}=e;const r=new URL(window.location.href);return r.searchParams.delete("channelId"),t.$$set=t=>{"totalResults"in t&&n(0,o=t.totalResults),"channelTitle"in t&&n(1,c=t.channelTitle)},[o,c,r]}class ct extends z{constructor(t){super(),M(this,t,ot,nt,r,{totalResults:0,channelTitle:1})}}function rt(t,e,n){const o=t.slice();return o[2]=e[n],o}function it(t,e){let n,o,c,r,i,f,h,m,b,y,v,k,w,x,T,P,I,_,A=e[2].title+"",E=e[2].channelTitle+"",R=e[2].publishedAt+"";return{key:t,first:null,c(){n=l("a"),o=l("img"),r=p(),i=l("p"),f=d(A),h=p(),m=l("p"),b=d(E),y=p(),v=l("p"),k=d(R),x=p(),T=l("a"),P=l("p"),P.textContent="このチャンネル内で検索",I=p(),o.src!==(c=e[2].thumbnailUrl)&&g(o,"src",c),g(o,"alt","thumbnail"),g(o,"width","320"),g(n,"href",w="https://www.youtube.com/watch?v="+e[2].id),g(n,"target","_blank"),g(n,"rel","noopener noreferrer"),g(T,"href",_=e[1](e[2].channelId)),this.first=n},m(t,e){a(t,n,e),u(n,o),u(n,r),u(n,i),u(i,f),u(n,h),u(n,m),u(m,b),u(n,y),u(n,v),u(v,k),a(t,x,e),a(t,T,e),u(T,P),u(T,I)},p(t,r){e=t,1&r&&o.src!==(c=e[2].thumbnailUrl)&&g(o,"src",c),1&r&&A!==(A=e[2].title+"")&&$(f,A),1&r&&E!==(E=e[2].channelTitle+"")&&$(b,E),1&r&&R!==(R=e[2].publishedAt+"")&&$(k,R),1&r&&w!==(w="https://www.youtube.com/watch?v="+e[2].id)&&g(n,"href",w),1&r&&_!==(_=e[1](e[2].channelId))&&g(T,"href",_)},d(t){t&&s(n),t&&s(x),t&&s(T)}}}function ut(e){let n,o=[],c=new Map,r=e[0];const i=t=>t[2].id;for(let t=0;t<r.length;t+=1){let n=rt(e,r,t),u=i(n);c.set(u,o[t]=it(u,n))}return{c(){for(let t=0;t<o.length;t+=1)o[t].c();n=f()},m(t,e){for(let n=0;n<o.length;n+=1)o[n].m(t,e);a(t,n,e)},p(t,[e]){3&e&&(r=t[0],o=function(t,e,n,o,c,r,i,u,a,s,l,d){let p=t.length,f=r.length,h=p;const g={};for(;h--;)g[t[h].key]=h;const $=[],m=new Map,b=new Map;for(h=f;h--;){const t=d(c,r,h),u=n(t);let a=i.get(u);a?o&&a.p(t,e):(a=s(u,t),a.c()),m.set(u,$[h]=a),u in g&&b.set(u,Math.abs(h-g[u]))}const y=new Set,v=new Set;function k(t){j(t,1),t.m(u,l),i.set(t.key,t),l=t.first,f--}for(;p&&f;){const e=$[f-1],n=t[p-1],o=e.key,c=n.key;e===n?(l=e.first,p--,f--):m.has(c)?!i.has(o)||y.has(o)?k(e):v.has(c)?p--:b.get(o)>b.get(c)?(v.add(o),k(e)):(y.add(c),p--):(a(n,i),p--)}for(;p--;){const e=t[p];m.has(e.key)||a(e,i)}for(;f;)k($[f-1]);return $}(o,e,i,1,t,r,c,n.parentNode,U,it,n,rt))},i:t,o:t,d(t){for(let e=0;e<o.length;e+=1)o[e].d(t);t&&s(n)}}}function at(t,e,n){let{videos:o}=e;return t.$$set=t=>{"videos"in t&&n(0,o=t.videos)},[o,t=>{const e=new URL(window.location.href);return e.searchParams.set("channelId",t),e.href}]}class st extends z{constructor(t){super(),M(this,t,at,ut,r,{videos:0})}}function lt(e){let n,o,c;return{c(){n=l("button"),n.textContent="前へ"},m(t,r){a(t,n,r),o||(c=h(n,"click",e[3]),o=!0)},p:t,d(t){t&&s(n),o=!1,c()}}}function dt(e){let n,o,c;return{c(){n=l("button"),n.textContent="次へ"},m(t,r){a(t,n,r),o||(c=h(n,"click",e[2]),o=!0)},p:t,d(t){t&&s(n),o=!1,c()}}}function pt(e){let n,o,c=e[0]&&lt(e),r=e[1]&&dt(e);return{c(){c&&c.c(),n=p(),r&&r.c(),o=f()},m(t,e){c&&c.m(t,e),a(t,n,e),r&&r.m(t,e),a(t,o,e)},p(t,[e]){t[0]?c?c.p(t,e):(c=lt(t),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null),t[1]?r?r.p(t,e):(r=dt(t),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},i:t,o:t,d(t){c&&c.d(t),t&&s(n),r&&r.d(t),t&&s(o)}}}function ft(t,e,n){let o,c;i(t,H,(t=>n(4,o=t))),i(t,V,(t=>n(5,c=t)));var r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(c,r){function i(t){try{a(o.next(t))}catch(t){r(t)}}function u(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?c(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,u)}a((o=o.apply(t,e||[])).next())}))};let{prevPageToken:u}=e,{nextPageToken:a}=e;const s=t=>r(void 0,void 0,void 0,(function*(){const e=Object.assign(Object.assign({},o),{pageToken:t}),n=yield J(c,e);console.log("result: ",n),G.set(n),H.set(e)}));return t.$$set=t=>{"prevPageToken"in t&&n(0,u=t.prevPageToken),"nextPageToken"in t&&n(1,a=t.nextPageToken)},[u,a,()=>r(void 0,void 0,void 0,(function*(){yield s(a)})),()=>r(void 0,void 0,void 0,(function*(){yield s(u)}))]}class ht extends z{constructor(t){super(),M(this,t,ft,pt,r,{prevPageToken:0,nextPageToken:1})}}function gt(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function $t(t){let e,n;return e=new ct({props:{totalResults:t[1].totalResults,channelTitle:t[6]}}),{c(){L(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.totalResults=t[1].totalResults),1&n&&(o.channelTitle=t[6]),e.$set(o)},i(t){n||(j(e.$$.fragment,t),n=!0)},o(t){N(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function mt(e){let n;return{c(){n=l("p"),n.textContent="...waiting"},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&s(n)}}}function bt(t){let e,n,o,c,r,i,u={ctx:t,current:null,token:null,hasCatch:!1,pending:mt,then:$t,catch:gt,value:6,blocks:[,,,]};return O(e=t[0],u),o=new st({props:{videos:t[1].videos}}),r=new ht({props:{prevPageToken:t[1].prevPageToken,nextPageToken:t[1].nextPageToken}}),{c(){u.block.c(),n=p(),L(o.$$.fragment),c=p(),L(r.$$.fragment)},m(t,e){u.block.m(t,u.anchor=e),u.mount=()=>n.parentNode,u.anchor=n,a(t,n,e),K(o,t,e),a(t,c,e),K(r,t,e),i=!0},p(n,[c]){if(t=n,u.ctx=t,1&c&&e!==(e=t[0])&&O(e,u));else{const e=t.slice();e[6]=u.resolved,u.block.p(e,c)}const i={};2&c&&(i.videos=t[1].videos),o.$set(i);const a={};2&c&&(a.prevPageToken=t[1].prevPageToken),2&c&&(a.nextPageToken=t[1].nextPageToken),r.$set(a)},i(t){i||(j(u.block),j(o.$$.fragment,t),j(r.$$.fragment,t),i=!0)},o(t){for(let t=0;t<3;t+=1){N(u.blocks[t])}N(o.$$.fragment,t),N(r.$$.fragment,t),i=!1},d(t){u.block.d(t),u.token=null,u=null,t&&s(n),q(o,t),t&&s(c),q(r,t)}}}function yt(t,e,n){let o,c;i(t,V,(t=>n(3,o=t))),i(t,G,(t=>n(1,c=t)));var r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(c,r){function i(t){try{a(o.next(t))}catch(t){r(t)}}function u(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?c(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,u)}a((o=o.apply(t,e||[])).next())}))};let u,{channelId:a}=e;const s=t=>r(void 0,void 0,void 0,(function*(){if(t){const e=yield(async(t,e)=>{const n=new URL(`${t.endpoint}?part=snippet&type=channel&channelId=${e}&key=${t.key}`).href,o=await fetch(n);return(await o.json()).items[0].snippet.channelTitle})(o,t);return console.log("channelTitle: ",e),e}return""}));return t.$$set=t=>{"channelId"in t&&n(2,a=t.channelId)},t.$$.update=()=>{4&t.$$.dirty&&n(0,u=s(a))},[u,c,a]}class vt extends z{constructor(t){super(),M(this,t,yt,bt,r,{channelId:2})}}function kt(t){let e,n,o,c,r;return n=new Y({props:{channelId:t[0]}}),c=new vt({props:{channelId:t[0]}}),{c(){e=l("main"),L(n.$$.fragment),o=p(),L(c.$$.fragment)},m(t,i){a(t,e,i),K(n,e,null),u(e,o),K(c,e,null),r=!0},p(t,[e]){const o={};1&e&&(o.channelId=t[0]),n.$set(o);const r={};1&e&&(r.channelId=t[0]),c.$set(r)},i(t){r||(j(n.$$.fragment,t),j(c.$$.fragment,t),r=!0)},o(t){N(n.$$.fragment,t),N(c.$$.fragment,t),r=!1},d(t){t&&s(e),q(n),q(c)}}}function wt(t,e,n){let o,{youtubeDataApiEndpoint:c}=e,{youtubeDataApiKey:r}=e;var i;return i=()=>{V.set({endpoint:c,key:r}),console.log("youtubeDataApiEndpoint: ",c),console.log("youtubeDataApiKey: ",r);const t=new URL(window.location.href);n(0,o=t.searchParams.get("channelId")||"")},v().$$.on_mount.push(i),t.$$set=t=>{"youtubeDataApiEndpoint"in t&&n(1,c=t.youtubeDataApiEndpoint),"youtubeDataApiKey"in t&&n(2,r=t.youtubeDataApiKey)},[o,c,r]}return new class extends z{constructor(t){super(),M(this,t,wt,kt,r,{youtubeDataApiEndpoint:1,youtubeDataApiKey:2})}}({target:document.body,props:{youtubeDataApiEndpoint:"https://www.googleapis.com/youtube/v3/search",youtubeDataApiKey:"AIzaSyAoVZET2gvLjZKBb4dksv6SzdU7SbOtMpw"}})}();
//# sourceMappingURL=bundle.js.map
